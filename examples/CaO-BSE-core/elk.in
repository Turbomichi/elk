
! This example demonstrates the calculation of the Ca 2p 1/2 - 2p 3/2 (L2 / L3)
! x-ray absorption spectra in CaO. The Ca 2p states are treated as local
! orbitals in Ca_lo.in (compare with the default version of Ca.in). Look at the
! imaginary part of the spectrum (EPSILON_BSE_11.OUT) in the range 11.8 to
! 12.5 Ha. Compare to the independent particle calculation (EPSILON_11.OUT).
! For a meaningful spectrum a lot more k-points (8 x 8 x 8 or more) are needed.
! The computation is very time and memory consuming. Run with hybrid
! parallelization (MPI across nodes, OpenMP across cores) on a cluster for
! smaller memory footprint. Compare with calculations and experimental data in
! J. Phys. Condens. Matter 23, 145501 (2011).

! Check convergence with respect to ncbse, nempty, gmaxrpa, gmaxvr, rgkmax.
! Large ngridk is crucial. Antiresonant parts of the BSE hamiltonian might
! be needed (use 'bsefull=.true.')

! Example by Markus Meinert.

tasks
 0	! ground-state calculation
 120	! compute momentum matrix elements
 121	! compute RPA dielectric function without local field contributions
 180	! generate RPA dielectric function with local field contributions
 185	! compute BSE dielectric function

! the code asks for at least one valence band state below E_F for the BSE
! calculation
nvbse
 1

! additional valence bands for the BSE calculation - these are the six 2p states
! of Ca (check EIGVAL.OUT)
istxbse
 1
 2
 3
 4
 5
 6

! number of conduction band states for the BSE calculation
ncbse
 14

! large number of empty states needed for screening calculation
nempty
 20

! G-vector cut-off of local contribution to RPA
gmaxrpa
 2.5

! the spectrum is very sensitive to the k-point mesh
ngridk
 4 4 4

! use a symmetry breaking shift for more efficient use of the k-points
vkloff
 0.01 0.03 0.05

! small radial step length
lradstp
 2

! Broyden mixing for fast convergence
mixtype
 3

! currently the energy window for the plot starts at zero by default; sufficient
! energy points needed
dos
 5000 100 0
 0.0 14.0

! include spin-orbit coupling for the 2p 1/2 - 2p 3/2 splitting
spinorb
 .true.

! about 0.136 eV - a bit better than typical experimental resolution
swidth
 0.005

! use a small step for searching the linearization energy (necessary for the
! deep semicore state)
deband
 0.01

! determines muffin-tin radii automatically
autormt
 .true.

sppath
  './'

avec
   4.545000000       4.545000000       0.000000000
   4.545000000      -4.545000000       0.000000000
   4.545000000       0.000000000       4.545000000

atoms
   2                                    : nspecies
 'Ca_lo.in'                             : spfname
   1                                    : natoms; atpos below
   0.00  0.00  0.00
 'O.in'
   1
   0.50  0.50  0.00

